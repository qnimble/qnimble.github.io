"use strict";(self.webpackChunkdoc_source=self.webpackChunkdoc_source||[]).push([[4211],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(n),d=r,f=m["".concat(l,".").concat(d)]||m[d]||c[d]||o;return n?a.createElement(f,i(i({ref:t},u),{},{components:n})):a.createElement(f,i({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8181:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return c}});var a=n(3117),r=n(102),o=(n(7294),n(3905)),i=["components"],s={sidebar_label:"Analog Response Time",title:"Analog System Response Time",hide_title:!1,hide_table_of_contents:!1,keywords:["Latency","ADC","DAC","Servo","Bandwidth"],description:"Understanding the system latency from analog to digital and back to analog."},l=void 0,p={unversionedId:"AppNotes/AnalogResponseTime",id:"AppNotes/AnalogResponseTime",title:"Analog System Response Time",description:"Understanding the system latency from analog to digital and back to analog.",source:"@site/Quarto/AppNotes/AnalogResponseTime.md",sourceDirName:"AppNotes",slug:"/AppNotes/AnalogResponseTime",permalink:"/Quarto/AppNotes/AnalogResponseTime",tags:[],version:"current",frontMatter:{sidebar_label:"Analog Response Time",title:"Analog System Response Time",hide_title:!1,hide_table_of_contents:!1,keywords:["Latency","ADC","DAC","Servo","Bandwidth"],description:"Understanding the system latency from analog to digital and back to analog."},sidebar:"autoSideBar",previous:{title:"Triggers",permalink:"/Quarto/Functions/Triggers"},next:{title:"Measuring Interrupt Latency",permalink:"/Quarto/AppNotes/InterruptLatency"}},u={},c=[{value:"Overview",id:"overview",level:2},{value:"DAC Update Time",id:"dac-update-time",level:3},{value:"Analog Output Filter",id:"analog-output-filter",level:3},{value:"Analog Input Filter",id:"analog-input-filter",level:3},{value:"ADC Measurement Time",id:"adc-measurement-time",level:3},{value:"Interrupt Latency",id:"interrupt-latency",level:3},{value:"MCU Processing Time",id:"mcu-processing-time",level:3},{value:"Entire Loop Delay",id:"entire-loop-delay",level:2}],m={toc:c};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"The analog response time is the time it takes from when an analog input changes to when a responding analog output changes. This total response time can be broken down into several parts as an analog input goes into the Quarto and makes it way to an analog output:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"DAC Update Latency"),(0,o.kt)("li",{parentName:"ol"},"Analog Output Filter"),(0,o.kt)("li",{parentName:"ol"},"Analog Input Filter"),(0,o.kt)("li",{parentName:"ol"},"ADC Measurement Latency"),(0,o.kt)("li",{parentName:"ol"},"Interrupt Latency"),(0,o.kt)("li",{parentName:"ol"},"MCU Processing Time")),(0,o.kt)("h3",{id:"dac-update-time"},"DAC Update Time"),(0,o.kt)("p",null,"The DAC Update Latency Time is 1\xb5s",(0,o.kt)("sup",{parentName:"p",id:"fnref-dac_measurementtime"},(0,o.kt)("a",{parentName:"sup",href:"#fn-dac_measurementtime",className:"footnote-ref"},"2")),"."),(0,o.kt)("h3",{id:"analog-output-filter"},"Analog Output Filter"),(0,o.kt)("p",null,"The output filter between the DAC and the ",(0,o.kt)("em",{parentName:"p"},"Quarto's")," Analog Output has a bandwidth of 180 kHz",(0,o.kt)("sup",{parentName:"p",id:"fnref-dac_measurementtime"},(0,o.kt)("a",{parentName:"sup",href:"#fn-dac_measurementtime",className:"footnote-ref"},"2")),". While this filter isn't a simple delay circuit, as the delay varies for different frequency components, for frequencies at 100 kHz or below, the delay is 1.2\xb5s."),(0,o.kt)("h3",{id:"analog-input-filter"},"Analog Input Filter"),(0,o.kt)("p",null,"The input filter in front of the Analog Input has a bandwidth of 400 kHz. While this filter isn't a simple delay circuit, as the delay varies for different frequency components, for  frequencies at 100 kHz or below, the delay is 550ns."),(0,o.kt)("h3",{id:"adc-measurement-time"},"ADC Measurement Time"),(0,o.kt)("p",null,"The ADC Measurement Time is 800ns",(0,o.kt)("sup",{parentName:"p",id:"fnref-adc_measurementtime"},(0,o.kt)("a",{parentName:"sup",href:"#fn-adc_measurementtime",className:"footnote-ref"},"1")),"."),(0,o.kt)("h3",{id:"interrupt-latency"},"Interrupt Latency"),(0,o.kt)("p",null,"Please see ",(0,o.kt)("a",{parentName:"p",href:"InterruptLatency"},"Measuring Interrupt Latency App Note")," note for details, but the worst-case interrupt latency is 210ns. "),(0,o.kt)("h3",{id:"mcu-processing-time"},"MCU Processing Time"),(0,o.kt)("p",null,"Clearly this depends on the function that that is executing. In the ",(0,o.kt)("a",{parentName:"p",href:"InterruptLatency"},"Measuring Interrupt Latency App Note")," the processing time was only 160ns. More complex functions will take longer to run. If unsure how long something takes to execute, as done in the app note, can you use a trigger line to measure the execution time with an O-scope. The code would be:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"triggerWrite(1,HIGH); // Set Trigger 1 high at start on function\nfunctiontoTime();\ntriggerWrite(1,LOW); // Set Trigger 1 low after function completes\n")),(0,o.kt)("p",null,"But for straight-forward arithmetic functions (no loops), 500ns is a safe estimate. "),(0,o.kt)("h2",{id:"entire-loop-delay"},"Entire Loop Delay"),(0,o.kt)("p",null,"In the case of a servo where the ",(0,o.kt)("em",{parentName:"p"},"Quarto's")," analog output is connected to its analog input, then we can measure the delay through the entire closed loop. If at t=0, we look at a signal at the ",(0,o.kt)("em",{parentName:"p"},"Quarto's")," analog input, then that signal gets to the ADC at time 800ns. The interrupt latency adds 210ns, so the MCU gets the data at time 1.01\xb5s. Assuming the MCU takes 290ns to calculate the DAC update value, then at t=1.3\xb5s the MCU updates the DAC. That update hits the DAC output at t=2.3\xb5s and gets through the output filter at 3.5\xb5s and through the ADC input filter at 4.05us. This means that the closed-loop signal delay is 4.05\xb5s. However, this ignores the sampling time of the ADC. If the ADC is sampling every 1\xb5s, then some information is delayed by nearly 1\xb5s before the ADC samples it and other information is barely delayed at all. A reasonable approximation is to assume that all signals are delayed by the average delay which is half the sampling time. When sampling every 1\xb5s, this adds an additional delay of 500ns. If sampling at 2\xb5s, then the extra delay would be 1\xb5s."),(0,o.kt)("p",null,"Putting this all together, for servo loop sampling every 1\xb5s, we have a total delay of 4.05\xb5s + 500ns = 4.55\xb5s. We would expect this setup to oscillate at 110 kHz, which is basically the measured oscillation frequency of 110 kHz."),(0,o.kt)("p",null,"In the case of a two channel servo where the sampling rate is every 2\xb5s, then the total delay is 5.05\xb5s, which should oscillate at 99kHz, which again is what we measure."),(0,o.kt)("div",{className:"footnotes"},(0,o.kt)("hr",{parentName:"div"}),(0,o.kt)("ol",{parentName:"div"},(0,o.kt)("li",{parentName:"ol",id:"fn-dac_measurementtime"},"See DAC section of ",(0,o.kt)("a",{parentName:"li",href:"../Specifications#digital-to-analog-converter-dac"},"Specifications Page"),".",(0,o.kt)("a",{parentName:"li",href:"#fnref-dac_measurementtime",className:"footnote-backref"},"\u21a9")),(0,o.kt)("li",{parentName:"ol",id:"fn-adc_measurementtime"},"See ADC section of ",(0,o.kt)("a",{parentName:"li",href:"../Specifications#analog-to-digital-converter-adc"},"Specifications Page"),".",(0,o.kt)("a",{parentName:"li",href:"#fnref-adc_measurementtime",className:"footnote-backref"},"\u21a9")))))}d.isMDXComponent=!0}}]);