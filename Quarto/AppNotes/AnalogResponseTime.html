<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<meta name="robots" content="noindex, nofollow">
<link rel="alternate" type="application/rss+xml" href="/News/rss.xml" title="qNimble RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/News/atom.xml" title="qNimble Atom Feed">
<link rel="alternate" type="application/json" href="/News/feed.json" title="qNimble JSON Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script src="https://js.qnimble.com/js/index.js" async defer="defer" data-domain="dev.qnimble.com" data-api="https://js.qnimble.com/qvbt/api/event"></script><title data-rh="true">Analog System Response Time | qNimble Quarto</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://qnimble.com/img/quarto-frontpanel.jpg"><meta data-rh="true" name="twitter:image" content="https://qnimble.com/img/quarto-frontpanel.jpg"><meta data-rh="true" property="og:url" content="https://qnimble.com/Quarto/AppNotes/AnalogResponseTime"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-quarto-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-quarto-current"><meta data-rh="true" property="og:title" content="Analog System Response Time | qNimble Quarto"><meta data-rh="true" name="description" content="Understanding the system latency from analog to digital and back to analog."><meta data-rh="true" property="og:description" content="Understanding the system latency from analog to digital and back to analog."><meta data-rh="true" name="keywords" content="Latency,ADC,DAC,Servo,Bandwidth"><link data-rh="true" rel="icon" href="/img/profile-256.png"><link data-rh="true" rel="canonical" href="https://qnimble.com/Quarto/AppNotes/AnalogResponseTime"><link data-rh="true" rel="alternate" href="https://qnimble.com/Quarto/AppNotes/AnalogResponseTime" hreflang="en"><link data-rh="true" rel="alternate" href="https://qnimble.com/Quarto/AppNotes/AnalogResponseTime" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c462e960.css">
<link rel="preload" href="/assets/js/runtime~main.63b206e7.js" as="script">
<link rel="preload" href="/assets/js/main.bdc2ff96.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="qNimble" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="qNimble" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">qNimble</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Quarto">Quarto</a><a class="navbar__item navbar__link" href="/Contact">Contact</a><a class="navbar__item navbar__link" href="/News">News</a><a class="navbar__item navbar__link" href="/Orders">Orders</a><a href="https://forum.qnimble.com" target="_target" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Quarto">Quarto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Quarto/Specifications">Specifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Quarto/Quick_Start">Quick Start Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Quarto/FAQ">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Quarto/Troubleshooting">Troubleshooting Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/Quarto/Examples">Program Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Examples/Filter">Analog Filter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Examples/Servo">PID Servo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Examples/Pulsed_Output">Pulsed Output Waveform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Examples/SDCard">SD Card</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Examples/Commands">Serial Commands</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/Quarto/Functions">Software Functions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Functions/ADC">ADC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Functions/DAC">DAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Functions/Digital">Digital I/O</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Functions/LEDs">LEDs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/Functions/Triggers">Triggers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">App Notes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Quarto/AppNotes/AnalogResponseTime">Analog Response Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Quarto/AppNotes/InterruptLatency">Measuring Interrupt Latency</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Quarto/Compliance">Compliance</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cwdi"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_xORG"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Analog System Response Time</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>The analog response time is the time it takes from when an analog input changes to when a responding analog output changes. This total response time can be broken down into several parts as an analog input goes into the Quarto and makes it way to an analog output:</p><ol><li>DAC Update Time</li><li>Analog Output Filter</li><li>Analog Input Filter</li><li>ADC Measurement Time</li><li>Interrupt Latency</li><li>MCU Processing Time</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="dac-update-time">DAC Update Time<a class="hash-link" href="#dac-update-time" title="Direct link to heading">​</a></h3><p>The DAC Measurement Time is 1µs<sup id="fnref-dac_measurementtime"><a href="#fn-dac_measurementtime" class="footnote-ref">2</a></sup>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="analog-output-filter">Analog Output Filter<a class="hash-link" href="#analog-output-filter" title="Direct link to heading">​</a></h3><p>The output filter between the DAC and the <em>Quarto&#x27;s</em> Analog Output has a bandwidth of 180 kHz<sup id="fnref-dac_measurementtime"><a href="#fn-dac_measurementtime" class="footnote-ref">2</a></sup>. While this filter isn&#x27;t a simple delay circuit, as the delay varies for different frequency components, for frequencies at 100 kHz or below, the delay is 1.2µs.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="analog-input-filter">Analog Input Filter<a class="hash-link" href="#analog-input-filter" title="Direct link to heading">​</a></h3><p>The input filter in front of the Analog Input has a bandwidth of 400 kHz. While this filter isn&#x27;t a simple delay circuit, as the delay varies for different frequency components, for  frequencies at 100 kHz or below, the delay is 550ns.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="adc-measurement-time">ADC Measurement Time<a class="hash-link" href="#adc-measurement-time" title="Direct link to heading">​</a></h3><p>The ADC Measurement Time is 800ns<sup id="fnref-adc_measurementtime"><a href="#fn-adc_measurementtime" class="footnote-ref">1</a></sup>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="interrupt-latency">Interrupt Latency<a class="hash-link" href="#interrupt-latency" title="Direct link to heading">​</a></h3><p>Please see <a href="/Quarto/AppNotes/InterruptLatency">Measuring Interrupt Latency App Note</a> note for details, but the worst-case interrupt latency is 210ns. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="mcu-processing-time">MCU Processing Time<a class="hash-link" href="#mcu-processing-time" title="Direct link to heading">​</a></h3><p>Clearly this depends on the function that that is executing. In the <a href="/Quarto/AppNotes/InterruptLatency">Measuring Interrupt Latency App Note</a> the processing time was only 160ns. More complex functions will take longer to run. If unsure how long something takes to execute, as done in the app note, can you use a trigger line to measure the execution time with an O-scope. The code would be:</p><div class="codeBlockContainer_I0IT language-c theme-code-block"><div class="codeBlockContent_wNvx c"><pre tabindex="0" class="prism-code language-c codeBlock_jd64 thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#e6db74">triggerWrite</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">HIGH</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> </span><span class="token comment" style="color:#8292a2;font-style:italic">// Set Trigger 1 high at start on function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#e6db74">functiontoTime</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#e6db74">triggerWrite</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">LOW</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> </span><span class="token comment" style="color:#8292a2;font-style:italic">// Set Trigger 1 low after function completes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>But for straight-forward arithmetic functions (no loops), 500ns is a safe estimate. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="entire-loop-delay">Entire Loop Delay<a class="hash-link" href="#entire-loop-delay" title="Direct link to heading">​</a></h2><p>In the case of a servo where the <em>Quarto&#x27;s</em> analog output is connected to its analog input, then we can measure the delay through the entire closed loop. If at t=0, we look at a signal at the <em>Quarto&#x27;s</em> analog input, then that signal gets to the ADC at time 800ns. The interrupt latency adds 210ns, so the MCU gets the data at time 1.21µs. Assuming conservatively the MCU takes 490ns to execute, then at t=1.6µs the MCU updates the DAC. That update hits the DAC output at t=2.6µs and gets through the output filter at 3.8µs. This means that the closed-loop signal delay is 3.8µs. However, this ignores the sampling time of the ADC. If the ADC is sampling every µs, then some information is delayed by nearly 1µs before the ADC samples it and other information is barely delayed at all. A reasonable approximation is to assume that all signals are delayed by the average delay which is half the sampling time. When sampling every µs, this adds an additional delay of 500ns. If sampling at 2µs, then the extra delay would be 1µs.</p><p>Putting this all together, for servo loop sampling every 1µs, we have a total delay of 3.8µs + 500ns = 4.3µs. We would expect this setup to oscillate at 115 kHz, which is very close to the measured oscillation frequency of 110 kHz.</p><p>In the case of a two channel servo where the sampling rate is every 2µs, then the total delay is 4.8µs, which should oscillate at 104kHz, which is very close to the measured 100 kHz.</p><div class="footnotes"><hr><ol><li id="fn-dac_measurementtime">See DAC section of <a href="/Quarto/Specifications#digital-to-analog-converter-dac">Specifications Page</a>.<a href="#fnref-dac_measurementtime" class="footnote-backref">↩</a></li><li id="fn-adc_measurementtime">See ADC section of <a href="/Quarto/Specifications#analog-to-digital-converter-adc">Specifications Page</a>.<a href="#fnref-adc_measurementtime" class="footnote-backref">↩</a></li></ol></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Quarto/Functions/Triggers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Triggers</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Quarto/AppNotes/InterruptLatency"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Measuring Interrupt Latency</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#dac-update-time" class="table-of-contents__link toc-highlight">DAC Update Time</a></li><li><a href="#analog-output-filter" class="table-of-contents__link toc-highlight">Analog Output Filter</a></li><li><a href="#analog-input-filter" class="table-of-contents__link toc-highlight">Analog Input Filter</a></li><li><a href="#adc-measurement-time" class="table-of-contents__link toc-highlight">ADC Measurement Time</a></li><li><a href="#interrupt-latency" class="table-of-contents__link toc-highlight">Interrupt Latency</a></li><li><a href="#mcu-processing-time" class="table-of-contents__link toc-highlight">MCU Processing Time</a></li></ul></li><li><a href="#entire-loop-delay" class="table-of-contents__link toc-highlight">Entire Loop Delay</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Privacy">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">368 Ontario St, Toronto ON, M5A 2V7 | Ontario, Canada | Phone: (720)-741-1556 <br> Copyright © 2022 <div class="baloo">qNimble</div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.63b206e7.js"></script>
<script src="/assets/js/main.bdc2ff96.js"></script>
</body>
</html>